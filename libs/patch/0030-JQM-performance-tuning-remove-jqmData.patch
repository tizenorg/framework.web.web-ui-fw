From c5e658e96ae2b60731934f6cc0cb8cdf1e515698 Mon Sep 17 00:00:00 2001
From: Minkyeong Kim <minkyeong.kim@samsung.com>
Date: Fri, 1 Feb 2013 14:15:11 +0900
Subject: [PATCH] [JQM] performance tuning : remove jqmData

---
 .../js/jquery.mobile.buttonMarkup.js               |   26 +++++++++++---------
 .../js/jquery.mobile.controlGroup.js               |    4 +--
 .../jquery-mobile-1.2.0/js/jquery.mobile.core.js   |    8 ++++++
 .../js/jquery.mobile.navigation.js                 |   12 ++++-----
 .../jquery-mobile-1.2.0/js/widgets/collapsible.js  |   26 ++++++++++----------
 .../js/widgets/collapsibleSet.js                   |    6 ++---
 libs/js/jquery-mobile-1.2.0/js/widgets/dialog.js   |    2 +-
 .../jquery-mobile-1.2.0/js/widgets/forms/button.js |    4 +--
 .../jquery-mobile-1.2.0/js/widgets/forms/select.js |    6 ++---
 .../jquery-mobile-1.2.0/js/widgets/forms/slider.js |    6 ++---
 .../js/widgets/forms/textinput.js                  |    2 +-
 .../js/widgets/listview.filter.js                  |    2 +-
 libs/js/jquery-mobile-1.2.0/js/widgets/listview.js |   22 ++++++++---------
 libs/js/jquery-mobile-1.2.0/js/widgets/popup.js    |    4 +--
 14 files changed, 70 insertions(+), 60 deletions(-)

diff --git a/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.buttonMarkup.js b/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.buttonMarkup.js
index 4d07961..7c17ba6 100644
--- a/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.buttonMarkup.js
+++ b/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.buttonMarkup.js
@@ -23,14 +23,14 @@ $.fn.buttonMarkup = function( options ) {
 		var el = $workingSet.eq( i ),
 			e = el[ 0 ],
 			o = $.extend( {}, $.fn.buttonMarkup.defaults, {
-				icon:       options.icon       !== undefined ? options.icon       : ( e.getAttribute( prefix + "icon" ) || undefined ),
-				iconpos:    options.iconpos    !== undefined ? options.iconpos    : ( e.getAttribute( prefix + "iconpos" ) || undefined ),
-				theme:      options.theme      !== undefined ? options.theme      : e.getAttribute( prefix + "theme" ) || $.mobile.getInheritedTheme( el, $.fn.buttonMarkup.defaults["theme"] ),
-				inline:     options.inline     !== undefined ? options.inline     : /^true$/i.test( e.getAttribute( prefix + "inline" ) ),
-				shadow:     options.shadow     !== undefined ? options.shadow     : !/^false$/i.test( e.getAttribute( prefix + "shadow" ) ),
-				corners:    options.corners    !== undefined ? options.corners    : !/^false$/i.test( e.getAttribute( prefix + "corners" ) ),
-				iconshadow: options.iconshadow !== undefined ? options.iconshadow : !/^false$/i.test( e.getAttribute( prefix + "iconshadow" ) ),
-				mini:       options.mini       !== undefined ? options.mini       : /^true$/i.test( e.getAttribute( prefix + "mini" ) )
+				icon:       options.icon       !== undefined ? options.icon       : $.mobile.getAttrFixed( e, prefix + "icon" ),
+				iconpos:    options.iconpos    !== undefined ? options.iconpos    : $.mobile.getAttrFixed( e, prefix + "iconpos" ),
+				theme:      options.theme      !== undefined ? options.theme      : $.mobile.getAttrFixed( e, prefix + "theme" ) || $.mobile.getInheritedTheme( el, $.fn.buttonMarkup.defaults["theme"] ),
+				inline:     options.inline     !== undefined ? options.inline     : $.mobile.getAttrFixed( e, prefix + "inline" ),
+				shadow:     options.shadow     !== undefined ? options.shadow     : $.mobile.getAttrFixed( e, prefix + "shadow" ),
+				corners:    options.corners    !== undefined ? options.corners    : $.mobile.getAttrFixed( e, prefix + "corners" ),
+				iconshadow: options.iconshadow !== undefined ? options.iconshadow : $.mobile.getAttrFixed( e, prefix + "iconshadow" ),
+				mini:       options.mini       !== undefined ? options.mini       : $.mobile.getAttrFixed( e, prefix + "mini" )
 			}, options ),
 
 			// Classes Defined
@@ -43,9 +43,11 @@ $.fn.buttonMarkup = function( options ) {
 			buttonIcon,
 			buttonElements;
 
-		$.each( o, mapToDataAttr );
+		for ( key in o ) {
+			e.setAttribute ( prefix + key, o[ key ])
+		}
 
-		if ( e.getAttribute( prefix + "rel" ) === "popup" && el.attr( "href" ) ) {
+		if ( $.mobile.getAttrFixed( e, prefix + "rel" ) === "popup" && el.attr( "href" ) ) {
 			e.setAttribute( "aria-haspopup", true );
 			e.setAttribute( "aria-owns", e.getAttribute( "href" ) );
 		}
@@ -82,12 +84,12 @@ $.fn.buttonMarkup = function( options ) {
 		buttonClass += o.corners ? " ui-btn-corner-all" : "";
 
 		// To distinguish real buttons
-		if( el.jqmData("role") == "button" || e.tagName == "BUTTON" || e.tagName == "DIV" ){
+		if(  $.mobile.getAttrFixed( e, prefix + "role" ) == "button" || e.tagName == "BUTTON" || e.tagName == "DIV" ){
 			buttonClass += " ui-btn-box-" + o.theme;
 		}
 
 		/* TIZEN style markup */
-		var buttonStyle = el.jqmData("style");
+		var buttonStyle =  $.mobile.getAttrFixed( e, prefix + "style" );
 
 		if ( buttonStyle == "circle" && !($(el).text().length > 0) ) {
 			/* style : no text, Icon only */
diff --git a/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.controlGroup.js b/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.controlGroup.js
index 9e72818..06c5312 100644
--- a/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.controlGroup.js
+++ b/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.controlGroup.js
@@ -20,10 +20,10 @@ $.fn.controlgroup = function( options ) {
 	return this.each(function() {
 		var $el = $( this ),
 			o = $.extend({
-						direction: $el.jqmData( "type" ) || "vertical",
+						direction:  $.mobile.getAttrFixed( $el[0], "data-"+ $.mobile.ns + "type" ) || "vertical",
 						shadow: false,
 						excludeInvisible: true,
-						mini: $el.jqmData( "mini" )
+						mini: $.mobile.getAttrFixed( $el[0], "data-"+ $.mobile.ns + "mini" )
 					}, options ),
 			grouplegend = $el.children( "legend" ),
 			groupheading = $el.children( ".ui-controlgroup-label" ),
diff --git a/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.core.js b/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.core.js
index 873293c..f8c3a2d 100644
--- a/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.core.js
+++ b/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.core.js
@@ -88,6 +88,14 @@ define( [ "jquery", "text!../version.txt" ], function( $, __version__ ) {
 		$window: $( window ),
 		$document: $( document ),
 
+		getAttrFixed : function( e, key ) {
+			var value = e.getAttribute( key );
+
+			return value === "true" ? true :
+				value === "false" ? false :
+				value === null ? undefined : value;
+		},
+
 		// TODO might be useful upstream in jquery itself ?
 		keyCode: {
 			ALT: 18,
diff --git a/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.navigation.js b/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.navigation.js
index 203557a..0a727b4 100644
--- a/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.navigation.js
+++ b/libs/js/jquery-mobile-1.2.0/js/jquery.mobile.navigation.js
@@ -1050,7 +1050,7 @@ define( [
 			activeIsInitialPage = urlHistory.activeIndex === 0,
 			historyDir = 0,
 			pageTitle = document.title,
-			isDialog = settings.role === "dialog" || toPage.jqmData( "role" ) === "dialog";
+			isDialog = settings.role === "dialog" || $.mobile.getAttrFixed( toPage [0], "data-" + $.mobile.ns + "role" ) === "dialog";
 
 		// By default, we prevent changePage requests when the fromPage and toPage
 		// are the same element, but folks that generate content manually/dynamically
@@ -1300,8 +1300,8 @@ define( [
 				{
 					type:		type && type.length && type.toLowerCase() || "get",
 					data:		$this.serialize(),
-					transition:	$this.jqmData( "transition" ),
-					reverse:	$this.jqmData( "direction" ) === "reverse",
+					transition:	$.mobile.getAttrFixed( $this [0], "data-" + $.mobile.ns + "transition" ),
+					reverse:	$.mobile.getAttrFixed( $this [0], "data-" + $.mobile.ns + "direction" ) === "reverse",
 					reloadPage:	true
 				}
 			);
@@ -1420,10 +1420,10 @@ define( [
 			}
 
 			//use ajax
-			var transition = $link.jqmData( "transition" ),
-				reverse = $link.jqmData( "direction" ) === "reverse" ||
+			var transition = $.mobile.getAttrFixed( $link [0], "data-" + $.mobile.ns + "transition" ),
+				reverse =  $.mobile.getAttrFixed( $link [0], "data-" + $.mobile.ns + "direction" ) === "reverse" ||
 							// deprecated - remove by 1.0
-							$link.jqmData( "back" ),
+							 $.mobile.getAttrFixed( $link [0], "data-" + $.mobile.ns + "back" ),
 
 				//this may need to be more specific as we use data-rel more
 				role = $link.attr( "data-" + $.mobile.ns + "rel" ) || undefined;
diff --git a/libs/js/jquery-mobile-1.2.0/js/widgets/collapsible.js b/libs/js/jquery-mobile-1.2.0/js/widgets/collapsible.js
index 41492ca..ad1ca3b 100644
--- a/libs/js/jquery-mobile-1.2.0/js/widgets/collapsible.js
+++ b/libs/js/jquery-mobile-1.2.0/js/widgets/collapsible.js
@@ -27,8 +27,8 @@ $.widget( "mobile.collapsible", $.mobile.widget, {
 			o = this.options,
 			collapsible = $el.addClass( "ui-collapsible" ),
 			collapsibleHeading = $el.children( o.heading ).first(),
-			collapsedIcon = $el.jqmData( "collapsed-icon" ) || o.collapsedIcon,
-			expandedIcon = $el.jqmData( "expanded-icon" ) || o.expandedIcon,
+			collapsedIcon = $.mobile.getAttrFixed( $el[0], "data-" + $.mobile.ns + "collapsed-icon" ) || o.collapsedIcon,
+			expandedIcon = $.mobile.getAttrFixed( $el[0], "data-" + $.mobile.ns + "expanded-icon" ) || o.expandedIcon,
 			collapsibleContent = collapsible.wrapInner( "<div class='ui-collapsible-content'></div>" ).children( ".ui-collapsible-content" ),
 			collapsibleSet = $el.closest( ":jqmData(role='collapsible-set')" ).addClass( "ui-collapsible-set" );
 
@@ -42,34 +42,34 @@ $.widget( "mobile.collapsible", $.mobile.widget, {
 		if ( collapsibleSet.length ) {
 			// Inherit the theme from collapsible-set
 			if ( !o.theme ) {
-				o.theme = collapsibleSet.jqmData( "theme" ) || $.mobile.getInheritedTheme( collapsibleSet, "c" );
+				o.theme = $.mobile.getAttrFixed( collapsibleSet[0], "data-" + $.mobile.ns + "theme" ) || $.mobile.getInheritedTheme( collapsibleSet, "c" );
 			}
 			// Inherit the content-theme from collapsible-set
 			if ( !o.contentTheme ) {
-				o.contentTheme = collapsibleSet.jqmData( "content-theme" );
+				o.contentTheme = $.mobile.getAttrFixed( collapsibleSet[0], "data-" + $.mobile.ns + "content-theme" );
 			}
 
 			// Get the preference for collapsed icon in the set
 			if ( !o.collapsedIcon ) {
-				o.collapsedIcon = collapsibleSet.jqmData( "collapsed-icon" );
+				o.collapsedIcon = $.mobile.getAttrFixed( collapsibleSet[0], "data-" + $.mobile.ns + "collapsed-icon" );
 			}
 			// Get the preference for expanded icon in the set
 			if ( !o.expandedIcon ) {
-				o.expandedIcon = collapsibleSet.jqmData( "expanded-icon" );
+				o.expandedIcon = $.mobile.getAttrFixed( collapsibleSet[0], "data-" + $.mobile.ns + "expanded-icon" );
 			}
 			// Gets the preference icon position in the set
 			if ( !o.iconPos ) {
-				o.iconPos = collapsibleSet.jqmData( "iconpos" );
+				o.iconPos = $.mobile.getAttrFixed( collapsibleSet[0], "data-" + $.mobile.ns + "iconpos" );
 			}
 			// Inherit the preference for inset from collapsible-set or set the default value to ensure equalty within a set
-			if ( collapsibleSet.jqmData( "inset" ) !== undefined ) {
-				o.inset = collapsibleSet.jqmData( "inset" );
+			if ( $.mobile.getAttrFixed( collapsibleSet[0], "data-" + $.mobile.ns + "inset" ) !== undefined ) {
+				o.inset = $.mobile.getAttrFixed( collapsibleSet[0], "data-" + $.mobile.ns + "inset" );
 			} else {
 				o.inset = true;
 			}
 			// Gets the preference for mini in the set
 			if ( !o.mini ) {
-				o.mini = collapsibleSet.jqmData( "mini" );
+				o.mini = $.mobile.getAttrFixed( collapsibleSet[0], "data-" + $.mobile.ns + "mini" );
 			}
 		} else {
 			// get inherited theme if not a set and no theme has been set
@@ -84,8 +84,8 @@ $.widget( "mobile.collapsible", $.mobile.widget, {
 		
 		collapsibleContent.addClass( ( o.contentTheme ) ? ( "ui-body-" + o.contentTheme ) : "");
 
-		collapsedIcon = $el.jqmData( "collapsed-icon" ) || o.collapsedIcon || "plus";
-		expandedIcon = $el.jqmData( "expanded-icon" ) || o.expandedIcon || "minus";
+		collapsedIcon = $.mobile.getAttrFixed( $el[0], "data-" + $.mobile.ns + "collapsed-icon" ) || o.collapsedIcon || "plus";
+		expandedIcon = $.mobile.getAttrFixed( $el[0], "data-" + $.mobile.ns + "expanded-icon" ) || o.expandedIcon || "minus";
 
 		collapsibleHeading
 			//drop heading in before content
@@ -99,7 +99,7 @@ $.widget( "mobile.collapsible", $.mobile.widget, {
 				.buttonMarkup({
 					shadow: false,
 					corners: false,
-					iconpos: $el.jqmData( "iconpos" ) || o.iconPos || "left",
+					iconpos: $.mobile.getAttrFixed( $el[0], "data-" + $.mobile.ns + "iconpos" ) || o.iconPos || "left",
 					icon: collapsedIcon,
 					mini: o.mini,
 					theme: o.theme
diff --git a/libs/js/jquery-mobile-1.2.0/js/widgets/collapsibleSet.js b/libs/js/jquery-mobile-1.2.0/js/widgets/collapsibleSet.js
index 4c5a419..ebc762d 100644
--- a/libs/js/jquery-mobile-1.2.0/js/widgets/collapsibleSet.js
+++ b/libs/js/jquery-mobile-1.2.0/js/widgets/collapsibleSet.js
@@ -23,11 +23,11 @@ $.widget( "mobile.collapsibleset", $.mobile.widget, {
 		}
 		// Inherit the content-theme from collapsible-set
 		if ( !o.contentTheme ) {
-			o.contentTheme = $el.jqmData( "content-theme" );
+			o.contentTheme = $.mobile.getAttrFixed( $el[0], "data-" + $.mobile.ns + "content-theme" );
 		}
 
-		if ( $el.jqmData( "inset" ) !== undefined ) {
-			o.inset = $el.jqmData( "inset" );
+		if ( $.mobile.getAttrFixed( $el[0], "data-" + $.mobile.ns + "inset" ) !== undefined ) {
+			o.inset = $.mobile.getAttrFixed( $el[0], "data-" + $.mobile.ns + "inset" );
 		}
 		o.inset = o.inset !== undefined ? o.inset : true;
 
diff --git a/libs/js/jquery-mobile-1.2.0/js/widgets/dialog.js b/libs/js/jquery-mobile-1.2.0/js/widgets/dialog.js
index d7a0795..9e390ef 100644
--- a/libs/js/jquery-mobile-1.2.0/js/widgets/dialog.js
+++ b/libs/js/jquery-mobile-1.2.0/js/widgets/dialog.js
@@ -59,7 +59,7 @@ $.widget( "mobile.dialog", $.mobile.widget, {
 			var $target = $( event.target ).closest( event.type === "vclick" ? "a" : "form" ),
 				active;
 
-			if ( $target.length && !$target.jqmData( "transition" ) ) {
+			if ( $target.length && !$.mobile.getAttrFixed( $target[0], "data-" + $.mobile.ns + "transition" ) ) {
 
 				active = $.mobile.urlHistory.getActive() || {};
 
diff --git a/libs/js/jquery-mobile-1.2.0/js/widgets/forms/button.js b/libs/js/jquery-mobile-1.2.0/js/widgets/forms/button.js
index 7b0141b..fe6d81c 100644
--- a/libs/js/jquery-mobile-1.2.0/js/widgets/forms/button.js
+++ b/libs/js/jquery-mobile-1.2.0/js/widgets/forms/button.js
@@ -25,8 +25,8 @@ $.widget( "mobile.button", $.mobile.widget, {
 			o = this.options,
 			type,
 			name,
-			inline = o.inline || $el.jqmData( "inline" ),
-			mini = o.mini || $el.jqmData( "mini" ),
+			inline = o.inline ||  $.mobile.getAttrFixed( $el[0], "data-" + $.mobile.ns + "inline" ),
+			mini = o.mini || $.mobile.getAttrFixed( $el[0], "data-" + $.mobile.ns + "mini" ),
 			classes = "",
 			$buttonPlaceholder;
 
diff --git a/libs/js/jquery-mobile-1.2.0/js/widgets/forms/select.js b/libs/js/jquery-mobile-1.2.0/js/widgets/forms/select.js
index a8b0f9f..9c78a90 100644
--- a/libs/js/jquery-mobile-1.2.0/js/widgets/forms/select.js
+++ b/libs/js/jquery-mobile-1.2.0/js/widgets/forms/select.js
@@ -89,9 +89,9 @@ $.widget( "mobile.selectmenu", $.mobile.widget, {
 
 			options = this.options,
 
-			inline = options.inline || this.select.jqmData( "inline" ),
-			mini = options.mini || this.select.jqmData( "mini" ),
-			iconpos = options.icon ? ( options.iconpos || this.select.jqmData( "iconpos" ) ) : false,
+			inline = options.inline ||  $.mobile.getAttrFixed( this.select[0], "data-" + $.mobile.ns + "inline" ),
+			mini = options.mini || $.mobile.getAttrFixed( this.select[0], "data-" + $.mobile.ns + "mini" ),
+			iconpos = options.icon ? ( options.iconpos || $.mobile.getAttrFixed( this.select[0], "data-" + $.mobile.ns + "iconpos" ) ) : false,
 
 			// IE throws an exception at options.item() function when
 			// there is no selected item
diff --git a/libs/js/jquery-mobile-1.2.0/js/widgets/forms/slider.js b/libs/js/jquery-mobile-1.2.0/js/widgets/forms/slider.js
index c6d4c9b..6729af7 100644
--- a/libs/js/jquery-mobile-1.2.0/js/widgets/forms/slider.js
+++ b/libs/js/jquery-mobile-1.2.0/js/widgets/forms/slider.js
@@ -55,9 +55,9 @@ $.widget( "mobile.slider", $.mobile.widget, {
 
 			step = window.parseFloat( control.attr( "step" ) || 1 ),
 
-			inlineClass = ( this.options.inline || control.jqmData( "inline" ) === true ) ? " ui-slider-inline" : "",
+			inlineClass = ( this.options.inline || $.mobile.getAttrFixed( control[0], "data-" + $.mobile.ns + "inline" ) === true ) ? " ui-slider-inline" : "",
 
-			miniClass = ( this.options.mini || control.jqmData( "mini" ) ) ? " ui-slider-mini" : "",
+			miniClass = ( this.options.mini || $.mobile.getAttrFixed( control[0], "data-" + $.mobile.ns + "min" ) ) ? " ui-slider-mini" : "",
 
 
 			domHandle = document.createElement( 'a' ),
@@ -65,7 +65,7 @@ $.widget( "mobile.slider", $.mobile.widget, {
 			domSlider = document.createElement( 'div' ),
 			slider = $( domSlider ),
 
-			valuebg = control.jqmData( "highlight" ) !== false && cType !== "select" ? (function() {
+			valuebg = $.mobile.getAttrFixed( control[0], "data-" + $.mobile.ns + "highlight" ) !== false && cType !== "select" ? (function() {
 				var bg = document.createElement('div');
 				bg.className = 'ui-slider-bg ' + $.mobile.activeBtnClass + ' ui-btn-corner-all';
 				return $( bg ).prependTo( slider );
diff --git a/libs/js/jquery-mobile-1.2.0/js/widgets/forms/textinput.js b/libs/js/jquery-mobile-1.2.0/js/widgets/forms/textinput.js
index 075d35d..9a7765e 100644
--- a/libs/js/jquery-mobile-1.2.0/js/widgets/forms/textinput.js
+++ b/libs/js/jquery-mobile-1.2.0/js/widgets/forms/textinput.js
@@ -25,7 +25,7 @@ $.widget( "mobile.textinput", $.mobile.widget, {
 			o = this.options,
 			theme = o.theme || $.mobile.getInheritedTheme( this.element, "c" ),
 			themeclass  = " ui-body-" + theme,
-			mini = input.jqmData( "mini" ) === true,
+			mini = $.mobile.getAttrFixed( input[0], "data-" + $.mobile.ns + "mini" ) === true,
 			miniclass = mini ? " ui-mini" : "",
 			focusedEl, clearbtn;
 
diff --git a/libs/js/jquery-mobile-1.2.0/js/widgets/listview.filter.js b/libs/js/jquery-mobile-1.2.0/js/widgets/listview.filter.js
index 0519b9a..b1ed1e4 100644
--- a/libs/js/jquery-mobile-1.2.0/js/widgets/listview.filter.js
+++ b/libs/js/jquery-mobile-1.2.0/js/widgets/listview.filter.js
@@ -69,7 +69,7 @@ $.mobile.$document.delegate( ":jqmData(role='listview')", "listviewcreate", func
 
 				for ( var i = listItems.length - 1; i >= 0; i-- ) {
 					item = $( listItems[ i ] );
-					itemtext = item.jqmData( "filtertext" ) || item.text();
+					itemtext =  $.mobile.getAttrFixed( item[0], "data-" + $.mobile.ns + "filtertext" ) || item.text();
 
 					if ( item.is( "li:jqmData(role=list-divider)" ) ) {
 
diff --git a/libs/js/jquery-mobile-1.2.0/js/widgets/listview.js b/libs/js/jquery-mobile-1.2.0/js/widgets/listview.js
index e46f842..e0d68f7 100644
--- a/libs/js/jquery-mobile-1.2.0/js/widgets/listview.js
+++ b/libs/js/jquery-mobile-1.2.0/js/widgets/listview.js
@@ -188,9 +188,9 @@ $.widget( "mobile.listview", $.mobile.widget, {
 		var o = this.options,
 			$list = this.element,
 			self = this,
-			dividertheme = $list.jqmData( "dividertheme" ) || o.dividerTheme,
-			listsplittheme = $list.jqmData( "splittheme" ),
-			listspliticon = $list.jqmData( "spliticon" ),
+			dividertheme = $.mobile.getAttrFixed( $list[0], "data-" + $.mobile.ns + "dividertheme" ) || o.dividerTheme,
+			listsplittheme =  $.mobile.getAttrFixed( $list[0], "data-" + $.mobile.ns + "splittheme" ),
+			listspliticon = $.mobile.getAttrFixed( $list[0], "data-" + $.mobile.ns + "spliticon" ),
 			li = this._getChildrenByTagName( $list[ 0 ], "li", "LI" ),
 			ol = !!$.nodeName( $list[ 0 ], "ol" ),
 			jsCount = !$.support.cssPseudoElement,
@@ -227,12 +227,12 @@ $.widget( "mobile.listview", $.mobile.widget, {
 
 			// If we're creating the element, we update it regardless
 			if ( create || !item.hasClass( "ui-li" ) ) {
-				itemTheme = item.jqmData( "theme" ) || o.theme;
+				itemTheme = $.mobile.getAttrFixed( item[0], "data-" + $.mobile.ns + "theme" ) || o.theme;
 				a = this._getChildrenByTagName( item[ 0 ], "a", "A" );
-				var isDivider = ( item.jqmData( "role" ) === "list-divider" );
+				var isDivider = ( $.mobile.getAttrFixed( item[0], "data-" + $.mobile.ns + "role" ) === "list-divider" );
 
 				if ( a.length && !isDivider ) {
-					icon = item.jqmData( "icon" );
+					icon = $.mobile.getAttrFixed( item[0], "data-" + $.mobile.ns + "icon" );
 
 					/* Remove auto populated right-arrow button. */
 					if ( icon === undefined ) {
@@ -258,8 +258,8 @@ $.widget( "mobile.listview", $.mobile.widget, {
 						itemClass += " ui-li-has-alt";
 
 						last = a.last();
-						splittheme = listsplittheme || last.jqmData( "theme" ) || o.splitTheme;
-						linkIcon = last.jqmData( "icon" );
+						splittheme = listsplittheme || $.mobile.getAttrFixed( last[0], "data-" + $.mobile.ns + "theme" ) || o.splitTheme;
+						linkIcon = $.mobile.getAttrFixed( last[0], "data-" + $.mobile.ns + "icon" );
 
 						last.appendTo( item )
 							.attr( "title", last.getEncodedText() )
@@ -351,7 +351,7 @@ $.widget( "mobile.listview", $.mobile.widget, {
 
 			.find( ".ui-li-count" ).each(function() {
 					$( this ).closest( "li" ).addClass( "ui-li-has-count" );
-				}).addClass( "ui-btn-up-" + ( $list.jqmData( "counttheme" ) || this.options.countTheme) + " ui-btn-corner-all" );
+				}).addClass( "ui-btn-up-" + ( $.mobile.getAttrFixed( $list[0], "data-" + $.mobile.ns + "counttheme" ) || this.options.countTheme) + " ui-btn-corner-all" );
 
 		// The idea here is to look at the first image in the list item
 		// itself, and any .ui-link-inherit element it may contain, so we
@@ -412,8 +412,8 @@ $.widget( "mobile.listview", $.mobile.widget, {
 				nodeEls = nodeElsFull.length ? nodeElsFull : $( "<span>" + $.trim(parent.contents()[ 0 ].nodeValue) + "</span>" ),
 				title = nodeEls.first().getEncodedText(),//url limits to first 30 chars of text
 				id = ( parentUrl || "" ) + "&" + $.mobile.subPageUrlKey + "=" + listId,
-				theme = list.jqmData( "theme" ) || o.theme,
-				countTheme = list.jqmData( "counttheme" ) || parentList.jqmData( "counttheme" ) || o.countTheme,
+				theme = $.mobile.getAttrFixed( list[0], "data-" + $.mobile.ns + "theme" ) || o.theme,
+				countTheme = $.mobile.getAttrFixed( list[0], "data-" + $.mobile.ns + "counttheme" ) || $.mobile.getAttrFixed( parentList[0], "data-" + $.mobile.ns + "counttheme" ) || o.countTheme,
 				newPage, anchor;
 
 			//define hasSubPages for use in later removal
diff --git a/libs/js/jquery-mobile-1.2.0/js/widgets/popup.js b/libs/js/jquery-mobile-1.2.0/js/widgets/popup.js
index 13cb548..35d1933 100644
--- a/libs/js/jquery-mobile-1.2.0/js/widgets/popup.js
+++ b/libs/js/jquery-mobile-1.2.0/js/widgets/popup.js
@@ -873,8 +873,8 @@ define( [ "jquery",
 			popup.popup( "open", {
 				x: offset.left + $link.outerWidth() / 2,
 				y: offset.top + $link.outerHeight() / 2,
-				transition: $link.jqmData( "transition" ),
-				positionTo: $link.jqmData( "position-to" ),
+				transition: $.mobile.getAttrFixed( $link[0], "data-" + $.mobile.ns + "transition" ),
+				positionTo: $.mobile.getAttrFixed( $link[0], "data-" + $.mobile.ns + "position-to" ),
 				link: $link
 			});
 		}
-- 
1.7.9.5


