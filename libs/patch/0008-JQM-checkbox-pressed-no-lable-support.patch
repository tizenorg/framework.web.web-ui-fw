From 412619cb65dfa87ee6485afa6bbe810a2705dd67 Mon Sep 17 00:00:00 2001
From: Minkyu Kang <mk7.kang@samsung.com>
Date: Wed, 29 Feb 2012 16:46:14 +0900
Subject: [PATCH] JQM: checkbox pressed, no-lable support

Signed-off-by: Koeun Choi <koeun.choi@samsung.com>
---
 .../js/jquery.mobile.forms.checkboxradio.js        |   57 ++++++++++++++++++-
 1 files changed, 54 insertions(+), 3 deletions(-)

diff --git a/libs/js/jquery-mobile-1.0.1pre/js/jquery.mobile.forms.checkboxradio.js b/libs/js/jquery-mobile-1.0.1pre/js/jquery.mobile.forms.checkboxradio.js
index d09a422..9243f2e 100644
--- a/libs/js/jquery-mobile-1.0.1pre/js/jquery.mobile.forms.checkboxradio.js
+++ b/libs/js/jquery-mobile-1.0.1pre/js/jquery.mobile.forms.checkboxradio.js
@@ -25,10 +25,23 @@ $.widget( "mobile.checkboxradio", $.mobile.widget, {
 			checkedicon = "ui-icon-" + checkedState,
 			uncheckedicon = "ui-icon-" + uncheckedState;
 
+		var checkedpressedicon = checkedicon + "-press",
+			uncheckedpressedicon = uncheckedicon + "-press";
+
 		if ( inputtype !== "checkbox" && inputtype !== "radio" ) {
 			return;
 		}
 
+		// Support fake label
+		if ( label.length == 0 ) {
+			label = $( "<label for='" + input[ 0 ].id  +
+				"' style='display:block;width:1px;height:1px;'></label>" );
+		}
+
+		// Wrap the input + label in a div
+		input.add( label )
+			.wrapAll( "<div class='ui-" + inputtype + "'></div>" );
+
 		// Expose for other methods
 		$.extend( this, {
 			label: label,
@@ -36,6 +49,8 @@ $.widget( "mobile.checkboxradio", $.mobile.widget, {
 			checkedClass: checkedClass,
 			uncheckedClass: uncheckedClass,
 			checkedicon: checkedicon,
+			checkedpressedicon: checkedpressedicon,
+			uncheckedpressedicon: uncheckedpressedicon,
 			uncheckedicon: uncheckedicon
 		});
 
@@ -50,11 +65,19 @@ $.widget( "mobile.checkboxradio", $.mobile.widget, {
 			shadow: false
 		});
 
-		// Wrap the input + label in a div
-		input.add( label )
-			.wrapAll( "<div class='ui-" + inputtype + "'></div>" );
+		if ( input.hasClass( "favorite" ) ) {
+			input.parent().addClass( "favorite" ).end();
+		}
 
 		label.bind({
+			vmousedown: function() {
+				self.press();
+			},
+			vmouseup: function() {
+				self.unpress();
+			},
+
+
 			vmouseover: function( event ) {
 				if ( $( this ).parent().is( ".ui-disabled" ) ) {
 					event.stopPropagation();
@@ -154,6 +177,34 @@ $.widget( "mobile.checkboxradio", $.mobile.widget, {
 		.checkboxradio( "refresh" );
 	},
 
+	press: function() {
+		var input = this.element,
+			label = this.label,
+			icon = label.find( ".ui-icon" );
+
+		if ( !$( input[ 0 ] ).is( ":disabled" ) ) {
+			if ( $( input[ 0 ] ).prop( "checked" ) ) {
+				icon.addClass( this.uncheckedpressedicon ).removeClass( this.checkedicon );
+			} else {
+				icon.removeClass( this.uncheckedicon ).addClass( this.checkedpressedicon );
+			}
+		}
+	},
+
+	unpress: function() {
+		var input = this.element,
+			label = this.label,
+			icon = label.find( ".ui-icon" );
+
+		if ( !$( input[ 0 ] ).is( ":disabled" ) ) {
+			if ( $( input[ 0 ] ).prop( "checked" ) ) {
+				icon.removeClass( this.uncheckedpressedicon ).addClass( this.uncheckedicon );
+			} else {
+				icon.addClass( this.checkedicon ).removeClass( this.checkedpressedicon );
+			}
+		}
+	},
+
 	refresh: function() {
 		var input = this.element,
 			label = this.label,
-- 
1.7.5.4

