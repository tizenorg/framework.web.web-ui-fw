<!DOCTYPE html>
<html>
	<head>
		<title>Engine events test</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<link rel="stylesheet" href="../../../../../../libs/qunit-1.11.0.css">
	</head>
	<body>
		<div id="qunit"></div>
		<div id="qunit-fixture">
			<div data-role="page" id="first"></div>
			<div data-role="page" id="two">
			</div>
		</div>
		<script src="../../../../../../libs/qunit-1.11.0.js" type="text/javascript"></script>
		<script src="../../../../../../libs/jquery.js"></script>
		<script src="../../../../../../libs/support.js"></script>
		<script>
			asyncTest('Events listener in correct order', 27, function () {
				var page = document.getElementById('first'),
					pageActive = document.getElementById('two'),
					order = 1;
				$(document).one('pagechange', function () {
					$(document).on("pagebeforechange", function(e) {
						ok(true, 'pagebeforechange event called');
						equal(e.target, document.body, "pagebeforechange target is body");
						equal(order++, 1, "Order correct pagebeforechange");
					}).on("pagebeforecreate", function(e) {
						ok(true, 'pagebeforecreate event called');
						equal(e.target, pageActive, "pagebeforecreate target is page");
						equal(order++, 2, "Order correct pagebeforecreate");
					}).on("pagecreate", function(e) {
						ok(true, 'pagecreate event called');
						equal(e.target, pageActive, "pagecreate target is page");
						equal(order++, 3, "Order correct pagecreate");
					}).on("pageinit", function(e) {
						ok(true, 'pageinit event called');
						equal(e.target, pageActive, "pageinit target is page");
						equal(order++, 4, "Order correct pageinit");
					}).on("pagebeforehide", function(e) {
						ok(true, 'pagebeforehide event called');
						equal(e.target, page, "pagebeforehide target is page");
						equal(order++, 5, "Order correct pagebeforehide");
					}).on("pagebeforeshow", function(e) {
						ok(true, 'pagebeforeshow event called');
						equal(e.target, pageActive, "pagebeforeshow target is page");
						equal(order++, 6, "Order correct pagebeforeshow");
					}).on("pagehide", function(e) {
						ok(true, 'pagehide event called');
						equal(e.target, page, "pagehide target is page");
						equal(order++, 7, "Order correct pagehide");
					}).on("pageshow", function(e) {
						ok(true, 'pageshow event called');
						equal(e.target, pageActive, "pageshow target is page");
						equal(order++, 8, "Order correct pageshow");
					}).on("pagechange", function(e) {
						ok(true, 'pagechange event called');
						equal(e.target, document.body, "pagechange target is body");
						equal(order, 9, "Order correct pagechange");
						start();
					});
					ej.engine.getRouter().open(pageActive);
				});
				ej.engine.run();
			});
		</script>
		<script type="text/javascript">
			var tauConfig = {
				"autorun": false
			};
		</script>
		<script src="../../../../../../libs/dist/js/tau.js" type="text/javascript"></script>

	</body>
</html>
